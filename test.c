/*
EXAMPLE 1
00 80        se_mflr   r0
18 21 06 F0  e_stwu    r1, -0x10(r1)
D5 01        se_stw    r0, 0x14(r1)
79 FF AF 09  e_bl      loc_21240
C5 01        se_lwz    r0, 0x14(r1)
00 D3        se_extsb  r3
00 90        se_mtlr   r0
20 F1        se_addi   r1, 0x10
00 04        se_blr

EXAMPLE 2
2D 07        se_bmaski r7, 0x10
70 D8 E3 FE  e_lis     r6, -0x3C02
70 0B 02 F0  e_li      r0, 0x5AF0
6D C3        se_slwi   r3, 0x1C
44 30        se_or     r0, r3
1C C6 C0 00  e_add16i  r6, r6, -0x4000
D1 06        se_stw    r0, 4(r6)
44 30        se_or     r0  r3
D1 06        se_stw    r0, 4(r6)
C0 06        se_lwz    r0, 0(r6)
66 40        se_btsti  r0, 4
E2 FE        se_bne    0xFFFFC8D0
00 04        se_blr

SE ONLY 3
04 7f        se_add    r31,r7
21 ec        se_addi   r28,31
46 10        se_and    r0,r1
47 01        se_and.   r1,r0
45 32        se_andc   r2,r3
2f 14        se_andi   r4,17
e8 fa        se_b      118 
e9 00        se_bl     126 0xe
e7 14        se_bso    150 
61 2b        se_bclri  r27,18
00 06        se_bctr
00 07        se_bctrl
63 17        se_bgeni  r7,17
00 04        se_blr
00 05        se_blrl
2c 06        se_bmaski r6,0
64 10        se_bseti  r0,1
66 74        se_btsti  r4,7
0c 10        se_cmp    r0,r1
0e cf        se_cmph   r31,r28
0f 91        se_cmphl  r1,r25
2b 63        se_cmpi   r3,22
0d 76        se_cmpl   r6,r7
22 bc        se_cmpli  r28,12
00 d1        se_extsb  r1
00 f2        se_extsh  r2
00 ce        se_extzb  r30
00 e8        se_extzh  r24
00 00        se_illegal
00 01        se_isync
88 18        se_lbz    r1,8(r24)
a9 84        se_lhz    r24,18(r4)
4c f4        se_li     r4,79
cf 60        se_lwz    r6,60(r0)
03 07        se_mfar   r7,r8
00 a3        se_mfctr  r3
00 84        se_mflr   r4
01 0f        se_mr     r31,r0
02 2f        se_mtar   r23,r2
00 b6        se_mtctr  r6
00 9f        se_mtlr   r31
05 43        se_mullw  r3,r4
00 38        se_neg    r24
00 29        se_not    r25
44 10        se_or     r0,r1
00 09        se_rfci
00 0a        se_rfdi
00 08        se_rfi
00 02        se_sc
42 65        se_slw    r5,r6
6c 77        se_slwi   r7,7
41 e6        se_sraw   r6,r30
6a 89        se_srawi  r25,8
40 0e        se_srw    r30,r0
69 9d        se_srwi   r29,25
9a 02        se_stb    r0,10(r2)
b6 1e        se_sth    r1,12(r30)
d0 7d        se_stw    r7,0(r29)
06 21        se_sub    r1,r2
07 ad        se_subf   r29,r26
25 77        se_subi   r7,24
27 29        se_subi.  r25,19
e9 c2        se_bl     118

E ONLY
1c 83 00 1b  e_add16i   r4  r3  27
70 c0 8c 56  e_add2i.   r0  13398
71 01 93 21  e_add2is   r1  17185
18 46 88 37  e_addi.    r2  r6  55
18 65 81 37  e_addi     r3  r5  14080
18 84 9a 37  e_addic.   r4  r4  3604480
18 e8 93 37  e_addic    r7  r8  922746880
71 3f ce ed  e_and2i.   r9  65261
71 40 e8 05  e_and2is.  r10 5
19 ab c8 39  e_andi.    r11 r13 57
19 ec c2 37  e_andi     r12 r15 3604480
78 00 00 ec  e_b        118 
78 00 00 01  e_bl       30
7a 03 ff cc  e_bns      0 
7a 1f 00 01  e_bsol     cr3 38  0x38
70 c2 9b 33  e_cmp16i   r2  13107
18 46 a9 37  e_cmpi     cr2 r6  14080
7c 87 58 1c  e_cmph     cr1 r7  r11
73 ec b5 ef  e_cmph16i  r12 -529
7c 06 40 5c  e_cmphl    cr0 r6  r8
70 4d ba 34  e_cmphl16i r13 4660
73 e1 ae e0  e_cmpl16i  r1  65248
18 a3 ab 37  e_cmpli    cr1 r3 922746880
7f a3 02 02  e_crand    4*cr7+gt so lt
7c 02 e9 02  e_crandc   lt eq 4*cr7+gt
7d f0 8a 42  e_creqv    4*cr3+so 4*cr4+lt 4*cr4+gt
7d e0 19 c2  e_crnand   4*cr3+so lt so
7d e0 18 42  e_crnor    4*cr3+so lt so
7d 8d 73 82  e_cror     4*cr3+lt 4*cr3+gt 4*cr3+eq
7e 72 8b 42  e_crorc    4*cr4+so 4*cr4+eq 4*cr4+gt
7c 00 01 82  e_crclr    lt
30 e3 cc 0d  e_lbz      r7  -13299(r3)
18 e5 00 cc  e_lbzu     r7  -52(r5)
39 0a 01 ff  e_lha      r8  511(r10)
19 01 03 ff  e_lhau     r8  -1(r1)
58 e0 18 38  e_lhz      r7  6200(0)
18 e0 01 3e  e_lhzu     r7  62(0)
70 06 1b 33  e_li       r0  209715
70 26 e3 33  e_lis      r1  13107
18 a3 08 18  e_lmw      r5  24(r3)
50 a3 27 28  e_lwz      r5  10024(r3)
18 c2 02 72  e_lwzu     r6  114(r2)
7c 98 00 20  e_mcrf     cr1 cr6
19 2a a0 37  e_mulli    r9  r10 55
70 01 a6 68  e_mull2i   r1  1640
70 a4 c3 45  e_or2i     r5  9029
70 b4 d3 45  e_or2is    r5  41797
19 27 d8 37  e_ori.     r7  r9  55
19 07 d1 37  e_ori      r7  r8  14080
7e d2 02 30  e_rlw      r18 r22 r0
7c 48 02 31  e_rlw.     r8  r2  r0
7c 74 aa 70  e_rlwi     r20 r3  21
7c 62 aa 71  e_rlwi.    r2  r3  21
76 64 6a 1e  e_rlwimi   r4  r19 13  8  15
74 24 68 63  e_rlwinm   r4  r1  13  1  17
7e 6c 30 70  e_slwi     r12 r19 6
7d 4c a0 71  e_slwi.    r12 r10 20
7c 20 84 70  e_srwi     r0  r1  16
7c 20 5c 71  e_srwi.    r0  r1  11
34 61 55 f0  e_stb      r3  22000(r1)
1a 76 04 fc  e_stbu     r19 -4(r22)
5c 15 02 9a  e_sth      r0  666(r21)
18 37 05 ff  e_sthu     r1  -1(r23)
18 03 09 04  e_stmw     r0  4(r3)
54 60 3f 21  e_stw      r3  16161(0)
1a c4 06 ee  e_stwu     r22 -18(r4)
18 15 b2 37  e_subfic   r0  r21 3604480
1a c0 bb 37  e_subfic.  r22 r0 922746880
18 75 e1 37  e_xori     r21 r3 14080
1a 80 e8 37  e_xori.    r0  r20 55
79 ff ff 82  e_b        118 
79 ff fe 67  e_bl       0 
*/

#include "vle.h"
#include <stdio.h>

const uint8_t example_1 [] = {0x00, 0x80, 0x18, 0x21, 0x06, 0xF0, 0xD5, 0x01, 0x79, 0xFF, 0xAF, 0x09, 0xC5, 0x01, 0x00, 0xD3, 0x00, 0x90, 0x20, 0xF1, 0x00, 0x04};
const uint8_t example_2 [] = {0x2D, 0x07, 0x70, 0xD8, 0xE3, 0xFE, 0x70, 0x0B, 0x02, 0xF0, 0x6D, 0xC3, 0x44, 0x30, 0x1C, 0xC6, 0xC0, 0x00, 0xD1, 0x06, 0x44, 0x30, 0x02, 0x78, 0xD1, 0x06, 0xC0, 0x06, 0x66, 0x40, 0xE2, 0xFE, 0x00, 0x04};
const uint8_t se_only []   = {0x04, 0x7f, 0x21, 0xec, 0x46, 0x10, 0x47, 0x01, 0x45, 0x32, 0x2f, 0x14, 0xe8, 0xfa, 0xe9, 0x00, 0xe7, 0x14, 0x61, 0x2b, 0x00, 0x06, 0x00, 0x07, 0x63, 0x17, 0x00, 0x04, 0x00, 0x05, 0x2c, 0x06, 0x64, 0x10, 0x66, 0x74, 0x0c, 0x10, 0x0e, 0xcf, 0x0f, 0x91, 0x2b, 0x63, 0x0d, 0x76, 0x22, 0xbc, 0x00, 0xd1, 0x00, 0xf2, 0x00, 0xce, 0x00, 0xe8, 0x00, 0x00, 0x00, 0x01, 0x88, 0x18, 0xa9, 0x84, 0x4c, 0xf4, 0xcf, 0x60, 0x03, 0x07, 0x00, 0xa3, 0x00, 0x84, 0x01, 0x0f, 0x02, 0x2f, 0x00, 0xb6, 0x00, 0x9f, 0x05, 0x43, 0x00, 0x38, 0x00, 0x29, 0x44, 0x10, 0x00, 0x09, 0x00, 0x0a, 0x00, 0x08, 0x00, 0x02, 0x42, 0x65, 0x6c, 0x77, 0x41, 0xe6, 0x6a, 0x89, 0x40, 0x0e, 0x69, 0x9d, 0x9a, 0x02, 0xb6, 0x1e, 0xd0, 0x7d, 0x06, 0x21, 0x07, 0xad, 0x25, 0x77, 0x27, 0x29, 0xe9, 0xc2};
const uint8_t e_only []    = {0x1c, 0x83, 0x00, 0x1b, 0x70, 0xc0, 0x8c, 0x56, 0x71, 0x01, 0x93, 0x21, 0x18, 0x46, 0x88, 0x37, 0x18, 0x65, 0x81, 0x37, 0x18, 0x84, 0x9a, 0x37, 0x18, 0xe8, 0x93, 0x37, 0x71, 0x3f, 0xce, 0xed, 0x71, 0x40, 0xe8, 0x05, 0x19, 0xab, 0xc8, 0x39, 0x19, 0xec, 0xc2, 0x37, 0x78, 0x00, 0x00, 0xec, 0x78, 0x00, 0x00, 0x01, 0x7a, 0x03, 0xff, 0xcc, 0x7a, 0x1f, 0x00, 0x01, 0x70, 0xc2, 0x9b, 0x33, 0x18, 0x46, 0xa9, 0x37, 0x7c, 0x87, 0x58, 0x1c, 0x73, 0xec, 0xb5, 0xef, 0x7c, 0x06, 0x40, 0x5c, 0x70, 0x4d, 0xba, 0x34, 0x73, 0xe1, 0xae, 0xe0, 0x18, 0xa3, 0xab, 0x37, 0x7f, 0xa3, 0x02, 0x02, 0x7c, 0x02, 0xe9, 0x02, 0x7d, 0xf0, 0x8a, 0x42, 0x7d, 0xe0, 0x19, 0xc2, 0x7d, 0xe0, 0x18, 0x42, 0x7d, 0x8d, 0x73, 0x82, 0x7e, 0x72, 0x8b, 0x42, 0x7c, 0x00, 0x01, 0x82, 0x30, 0xe3, 0xcc, 0x0d, 0x18, 0xe5, 0x00, 0xcc, 0x39, 0x0a, 0x01, 0xff, 0x19, 0x01, 0x03, 0xff, 0x58, 0xe0, 0x18, 0x38, 0x18, 0xe0, 0x01, 0x3e, 0x70, 0x06, 0x1b, 0x33, 0x70, 0x26, 0xe3, 0x33, 0x18, 0xa3, 0x08, 0x18, 0x50, 0xa3, 0x27, 0x28, 0x18, 0xc2, 0x02, 0x72, 0x7c, 0x98, 0x00, 0x20, 0x19, 0x2a, 0xa0, 0x37, 0x70, 0x01, 0xa6, 0x68, 0x70, 0xa4, 0xc3, 0x45, 0x70, 0xb4, 0xd3, 0x45, 0x19, 0x27, 0xd8, 0x37, 0x19, 0x07, 0xd1, 0x37, 0x7e, 0xd2, 0x02, 0x30, 0x7c, 0x48, 0x02, 0x31, 0x7c, 0x74, 0xaa, 0x70, 0x7c, 0x62, 0xaa, 0x71, 0x76, 0x64, 0x6a, 0x1e, 0x74, 0x24, 0x68, 0x63, 0x7e, 0x6c, 0x30, 0x70, 0x7d, 0x4c, 0xa0, 0x71, 0x7c, 0x20, 0x84, 0x70, 0x7c, 0x20, 0x5c, 0x71, 0x34, 0x61, 0x55, 0xf0, 0x1a, 0x76, 0x04, 0xfc, 0x5c, 0x15, 0x02, 0x9a, 0x18, 0x37, 0x05, 0xff, 0x18, 0x03, 0x09, 0x04, 0x54, 0x60, 0x3f, 0x21, 0x1a, 0xc4, 0x06, 0xee, 0x18, 0x15, 0xb2, 0x37, 0x1a, 0xc0, 0xbb, 0x37, 0x18, 0x75, 0xe1, 0x37, 0x1a, 0x80, 0xe8, 0x37, 0x79, 0xff, 0xff, 0x82, 0x79, 0xff, 0xfe, 0x67}; 

int main(int argc, char const *argv[]) {
	printf("example 1\n");
	decode(example_1, sizeof(example_1));
	printf("\n\nexample 2\n");
	decode(example_2, sizeof(example_2));
	printf("\n\nse_only\n");
	decode(se_only, sizeof(se_only));
	printf("\n\ne_only\n");
	decode(e_only, sizeof(e_only));
	return 0;
}